@using BioEngine.BRC.Core.Users
@using BioEngine.BRC.Admin.Components
@inherits LayoutComponentBase
@inject ICurrentUserProvider CurrentUserProvider
<RadzenDialog/>
<RadzenNotification/>
<RadzenContextMenu/>
<RadzenTooltip/>

<nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
    <a class="navbar-brand" href="/">BRC Games</a>
    <button class="btn btn-link btn-sm order-1 order-lg-0" id="sidebarToggle" href="#">
        <i class="fas fa-bars"></i>
    </button>
    <!-- Navbar Search-->
    <div class="d-none d-md-inline-block form-inline ml-auto mr-0 mr-md-3 my-2 my-md-0">
    </div>
    <!-- Navbar-->
    <ul class="navbar-nav ml-auto ml-md-0">
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" id="userDropdown" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img src="@CurrentUserProvider.CurrentUser!.PhotoUrl" width="25" height="25" class="rounded-circle" alt="@CurrentUserProvider.CurrentUser.Name"/>
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                <a class="dropdown-item" href="@CurrentUserProvider.CurrentUser!.ProfileUrl" target="_blank">Профиль</a>
            </div>
        </li>
    </ul>
</nav>

<div id="layoutSidenav">
    <div id="layoutSidenav_nav">
        <Menu Groups="MenuGroups"></Menu>
    </div>
    <div id="layoutSidenav_content">
        <main>
            <div class="container-fluid">
                @Body
            </div>
        </main>
        <footer class="py-4 bg-light mt-auto">
            <div class="container-fluid">
                <div class="d-flex align-items-center justify-content-between small">
                    <div class="text-muted">Copyright &copy; BRC Games @DateTimeOffset.UtcNow.Year</div>
                    <div>
                        <a href="#">Privacy Policy</a>
                        &middot;
                        <a href="#">Terms &amp; Conditions</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>
</div>

@code {
    public MenuBuilderGroup[] MenuGroups;

    protected override void OnInitialized()
    {
        var menuBuilder = new MenuBuilder();
        menuBuilder.AddGroup("Admin").AddItem("Dashboard", "fas fa-tachometer-alt", "/Dashboard");
        var contentGroup = menuBuilder.AddGroup("Контент");
        contentGroup.AddItem("Посты", "fas fa-columns")
            .AddChild("Список", "/Posts/Index")
            .AddChild("Добавить", "/Posts/Add");
        contentGroup.AddItem("Страницы", "fas fa-book-open")
            .AddChild("Список", "/Pages/Index")
            .AddChild("Добавить", "/Pages/Add");
        menuBuilder.AddGroup("Разное").AddItem("Файлы", "fas fa-hdd", "/Storage/Index");
        MenuGroups = menuBuilder.Groups;
    }

}
