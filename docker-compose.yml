version: '2'
services:
    postgres:
        image: postgres:11.2-alpine
        ports:
            - 5432:5432
        volumes:
            - /var/data/brc/postgres/11.2:/var/lib/postgresql/data
        environment:
            - POSTGRES_USER=brc
            - POSTGRES_PASSWORD=123
    minio:
        image: minio/minio
        command: server /data
        ports:
            - 9876:9000
        volumes:
            - /var/data/brc/minio/files:/data
            - /var/data/brc/minio/config:/root/.minio
        environment:
            - MINIO_ACCESS_KEY=2zdj83LPN4pTCREJ
            - MINIO_SECRET_KEY=rQPjWQqtFqJbH3furiNc2i9vrpBYJint
    elasticsearch:
        image: docker.elastic.co/elasticsearch/elasticsearch:7.8.0
        environment:
            ES_JAVA_OPTS: "-Xms1g -Xmx1g"
            cluster.name: "sites"
            xpack.security.enabled: "false"
            bootstrap.memory_lock: "true"
            discovery.type: "single-node"
        ulimits:
            memlock:
                soft: -1
                hard: -1
            nproc: 65535
            nofile:
                soft: 20000
                hard: 120000
        volumes:
            - elastic:/usr/share/elasticsearch/data
            - ./../hunspell:/usr/share/elasticsearch/config/hunspell
        ports:
            - 9200:9200
    dejavu:
        image: appbaseio/dejavu
        ports:
            - 1358:1358

volumes:
    elastic:
